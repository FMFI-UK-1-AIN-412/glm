#!/usr/local/bin/python3

import argparse

from remote.context import Context
import student.utils as Utils
from remote.repository.github_repository import GithubRepository
from remote.organization.github_organization import GithubOrganization
from remote.pull_request.utils import get_pull_requests

parser = argparse.ArgumentParser()
parser.add_argument("-s", "--student", help="Student crud operations", action="store_true")
parser.add_argument("-p", "--pulls", help="Fetch and save student pull requests", action="store_true")
args = parser.parse_args()

context = Context()

if args.pulls:
    repositories = []
    for student in Utils.get_all_students():
        repositories.append(context.get_repository(student))

    for repo in repositories:
        pulls = repo.get_pull_requests()
        for p in pulls:
            print(p)
            p.save()

if args.student:
    for student in Utils.get_all_students():
        print(student)
